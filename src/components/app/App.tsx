import { useCallback, useMemo, useState } from "react";
import { CandlestickChart } from "../candlestick-chart/CandlestickChart";
import { CandlestickChartV2 } from "../candlestick-chart-v2/CandlestickChartV2";
import { DonutChart } from "../donut-chart/DonutChart";
import { LineChart } from "../line-chart/LineChart";
import { LineChartV2 } from "../line-chart-v2/LineChartV2";
import { LineChartV3 } from "../line-chart-v3/LineChartV3";

const DATA = [
    [
        "2022-03-24T06:00:00Z",
        0.0181,
        0.0181,
        0.0181,
        0.0181,
        1869940000
    ],
    [
        "2022-03-24T07:00:00Z",
        0.01811,
        0.02177,
        0.015995,
        0.019695,
        65361150000
    ],
    [
        "2022-03-24T08:00:00Z",
        0.0197,
        0.0204,
        0.01967,
        0.019725,
        37060060000
    ],
    [
        "2022-03-24T09:00:00Z",
        0.019715,
        0.01973,
        0.01905,
        0.0192,
        16742430000
    ],
    [
        "2022-03-24T10:00:00Z",
        0.0192,
        0.0192,
        0.018975,
        0.019,
        9352830000
    ],
    [
        "2022-03-25T06:00:00Z",
        0.0197,
        0.0197,
        0.0197,
        0.0197,
        290020000
    ],
    [
        "2022-03-25T07:00:00Z",
        0.019685,
        0.019805,
        0.0171,
        0.017475,
        34907010000
    ],
    [
        "2022-03-25T08:00:00Z",
        0.01747,
        0.0179,
        0.017335,
        0.0176,
        18843940000
    ],
    [
        "2022-03-25T09:00:00Z",
        0.0176,
        0.017665,
        0.01745,
        0.0175,
        9699020000
    ],
    [
        "2022-03-25T10:00:00Z",
        0.0175,
        0.01755,
        0.01745,
        0.0175,
        7672440000
    ],
    [
        "2022-03-28T06:00:00Z",
        0.017545,
        0.017545,
        0.017545,
        0.017545,
        132550000
    ],
    [
        "2022-03-28T07:00:00Z",
        0.01755,
        0.017695,
        0.0165,
        0.016895,
        22545680000
    ],
    [
        "2022-03-28T08:00:00Z",
        0.016895,
        0.01704,
        0.0168,
        0.01702,
        6610690000
    ],
    [
        "2022-03-28T09:00:00Z",
        0.01702,
        0.017035,
        0.01692,
        0.016965,
        4415080000
    ],
    [
        "2022-03-28T10:00:00Z",
        0.01696,
        0.016975,
        0.01683,
        0.01685,
        4278400000
    ],
    [
        "2022-03-29T06:00:00Z",
        0.01687,
        0.01687,
        0.01687,
        0.01687,
        172390000
    ],
    [
        "2022-03-29T07:00:00Z",
        0.01687,
        0.017945,
        0.01685,
        0.01756,
        16931970000
    ],
    [
        "2022-03-29T08:00:00Z",
        0.017575,
        0.017875,
        0.01735,
        0.017755,
        12039930000
    ],
    [
        "2022-03-29T09:00:00Z",
        0.017755,
        0.017765,
        0.01622,
        0.016335,
        17580260000
    ],
    [
        "2022-03-29T10:00:00Z",
        0.016335,
        0.01671,
        0.0163,
        0.0165,
        12238230000
    ],
    [
        "2022-03-30T06:00:00Z",
        0.01755,
        0.01755,
        0.01755,
        0.01755,
        357110000
    ],
    [
        "2022-03-30T07:00:00Z",
        0.0175,
        0.017545,
        0.01702,
        0.017155,
        19096110000
    ],
    [
        "2022-03-30T08:00:00Z",
        0.01715,
        0.017195,
        0.016945,
        0.01704,
        7382830000
    ],
    [
        "2022-03-30T09:00:00Z",
        0.017045,
        0.01719,
        0.01701,
        0.01715,
        6500430000
    ],
    [
        "2022-03-30T10:00:00Z",
        0.017155,
        0.0172,
        0.017125,
        0.017155,
        7472070000
    ],
    [
        "2022-03-31T06:00:00Z",
        0.017355,
        0.017355,
        0.017355,
        0.017355,
        175840000
    ],
    [
        "2022-03-31T07:00:00Z",
        0.017355,
        0.018775,
        0.017355,
        0.01849,
        45044420000
    ],
    [
        "2022-03-31T08:00:00Z",
        0.018495,
        0.01865,
        0.018005,
        0.01825,
        16661800000
    ],
    [
        "2022-03-31T09:00:00Z",
        0.01825,
        0.018955,
        0.01824,
        0.01864,
        24253010000
    ],
    [
        "2022-03-31T10:00:00Z",
        0.018655,
        0.0195,
        0.01852,
        0.01949,
        21272040000
    ],
    [
        "2022-03-31T11:00:00Z",
        0.01949,
        0.01992,
        0.019115,
        0.019645,
        30128560000
    ],
    [
        "2022-03-31T12:00:00Z",
        0.01966,
        0.01969,
        0.019,
        0.019365,
        14163850000
    ],
    [
        "2022-03-31T13:00:00Z",
        0.01939,
        0.01977,
        0.01903,
        0.019665,
        11151710000
    ],
    [
        "2022-03-31T14:00:00Z",
        0.019645,
        0.019675,
        0.01922,
        0.01959,
        9707030000
    ],
    [
        "2022-03-31T15:00:00Z",
        0.01959,
        0.0198,
        0.019555,
        0.0198,
        10701550000
    ],
    [
        "2022-04-01T06:00:00Z",
        0.0205,
        0.0205,
        0.0205,
        0.0205,
        974040000
    ],
    [
        "2022-04-01T07:00:00Z",
        0.0205,
        0.0215,
        0.019895,
        0.02135,
        59712900000
    ],
    [
        "2022-04-01T08:00:00Z",
        0.02135,
        0.0216,
        0.02041,
        0.02074,
        25561110000
    ],
    [
        "2022-04-01T09:00:00Z",
        0.02075,
        0.021235,
        0.020685,
        0.021005,
        12033530000
    ],
    [
        "2022-04-01T10:00:00Z",
        0.021005,
        0.02125,
        0.0208,
        0.021135,
        9927810000
    ],
    [
        "2022-04-01T11:00:00Z",
        0.021135,
        0.02139,
        0.02108,
        0.02131,
        7851080000
    ],
    [
        "2022-04-01T12:00:00Z",
        0.02131,
        0.02147,
        0.0209,
        0.02133,
        11471790000
    ],
    [
        "2022-04-01T13:00:00Z",
        0.021345,
        0.022885,
        0.02133,
        0.02288,
        37165480000
    ],
    [
        "2022-04-01T14:00:00Z",
        0.022875,
        0.023845,
        0.022505,
        0.022705,
        55505280000
    ],
    [
        "2022-04-01T15:00:00Z",
        0.02269,
        0.0229,
        0.022135,
        0.0225,
        22602430000
    ],
    [
        "2022-04-04T06:00:00Z",
        0.02302,
        0.02302,
        0.02302,
        0.02302,
        2033320000
    ],
    [
        "2022-04-04T07:00:00Z",
        0.02302,
        0.02475,
        0.0225,
        0.023385,
        100355350000
    ],
    [
        "2022-04-04T08:00:00Z",
        0.023385,
        0.023995,
        0.023,
        0.023705,
        29592630000
    ],
    [
        "2022-04-04T09:00:00Z",
        0.0237,
        0.024215,
        0.0236,
        0.024155,
        26671270000
    ],
    [
        "2022-04-04T10:00:00Z",
        0.024175,
        0.02458,
        0.023905,
        0.02417,
        39638300000
    ],
    [
        "2022-04-04T11:00:00Z",
        0.024165,
        0.02435,
        0.02399,
        0.0242,
        7669080000
    ],
    [
        "2022-04-05T06:00:00Z",
        0.0258,
        0.0258,
        0.0258,
        0.0258,
        1628620000
    ],
    [
        "2022-04-05T07:00:00Z",
        0.02581,
        0.02636,
        0.02406,
        0.024185,
        90666470000
    ],
    [
        "2022-04-05T08:00:00Z",
        0.024205,
        0.025095,
        0.023315,
        0.024445,
        56788410000
    ],
    [
        "2022-04-05T09:00:00Z",
        0.024415,
        0.02468,
        0.0234,
        0.02379,
        40200440000
    ],
    [
        "2022-04-05T10:00:00Z",
        0.023795,
        0.024095,
        0.022265,
        0.02237,
        37315160000
    ],
    [
        "2022-04-05T11:00:00Z",
        0.02237,
        0.02367,
        0.0218,
        0.023395,
        50157850000
    ],
    [
        "2022-04-05T12:00:00Z",
        0.023395,
        0.0247,
        0.0233,
        0.02384,
        42545080000
    ],
    [
        "2022-04-05T13:00:00Z",
        0.02385,
        0.024135,
        0.0232,
        0.023475,
        19698060000
    ],
    [
        "2022-04-05T14:00:00Z",
        0.023475,
        0.02364,
        0.02284,
        0.02304,
        14335850000
    ],
    [
        "2022-04-05T15:00:00Z",
        0.02304,
        0.02341,
        0.023,
        0.02308,
        8209870000
    ],
    [
        "2022-04-06T06:00:00Z",
        0.02202,
        0.02202,
        0.02202,
        0.02202,
        872170000
    ],
    [
        "2022-04-06T07:00:00Z",
        0.02209,
        0.0227,
        0.02122,
        0.022345,
        54647240000
    ],
    [
        "2022-04-06T08:00:00Z",
        0.022365,
        0.02259,
        0.022035,
        0.022575,
        11324470000
    ],
    [
        "2022-04-06T09:00:00Z",
        0.022575,
        0.0235,
        0.022445,
        0.023355,
        22358400000
    ],
    [
        "2022-04-06T10:00:00Z",
        0.02337,
        0.0235,
        0.0227,
        0.022825,
        17987130000
    ],
    [
        "2022-04-06T11:00:00Z",
        0.02281,
        0.023,
        0.02235,
        0.02267,
        11409510000
    ],
    [
        "2022-04-06T12:00:00Z",
        0.02267,
        0.02278,
        0.022525,
        0.022625,
        5103460000
    ],
    [
        "2022-04-06T13:00:00Z",
        0.02265,
        0.02278,
        0.022525,
        0.02255,
        5055320000
    ],
    [
        "2022-04-06T14:00:00Z",
        0.02255,
        0.0226,
        0.02202,
        0.02207,
        11836610000
    ],
    [
        "2022-04-06T15:00:00Z",
        0.022065,
        0.02225,
        0.02185,
        0.02195,
        8529100000
    ],
    [
        "2022-04-07T06:00:00Z",
        0.02198,
        0.02198,
        0.02198,
        0.02198,
        171660000
    ],
    [
        "2022-04-07T07:00:00Z",
        0.021995,
        0.023115,
        0.021995,
        0.02268,
        32230190000
    ],
    [
        "2022-04-07T08:00:00Z",
        0.02269,
        0.0229,
        0.022475,
        0.02285,
        8223600000
    ],
    [
        "2022-04-07T09:00:00Z",
        0.02285,
        0.023075,
        0.02262,
        0.022725,
        13530320000
    ],
    [
        "2022-04-07T10:00:00Z",
        0.02274,
        0.022805,
        0.02262,
        0.02272,
        3852290000
    ],
    [
        "2022-04-07T11:00:00Z",
        0.022725,
        0.022895,
        0.022705,
        0.022715,
        4548250000
    ],
    [
        "2022-04-07T12:00:00Z",
        0.022725,
        0.022795,
        0.02252,
        0.0226,
        3707160000
    ],
    [
        "2022-04-07T13:00:00Z",
        0.022615,
        0.022675,
        0.022385,
        0.02254,
        6953980000
    ],
    [
        "2022-04-07T14:00:00Z",
        0.02254,
        0.02261,
        0.02247,
        0.02253,
        2488270000
    ],
    [
        "2022-04-07T15:00:00Z",
        0.022515,
        0.022845,
        0.02239,
        0.02281,
        5242120000
    ],
    [
        "2022-04-08T06:00:00Z",
        0.023095,
        0.023095,
        0.023095,
        0.023095,
        263660000
    ],
    [
        "2022-04-08T07:00:00Z",
        0.02306,
        0.02328,
        0.022275,
        0.0226,
        19774880000
    ],
    [
        "2022-04-08T08:00:00Z",
        0.02258,
        0.0227,
        0.022405,
        0.022425,
        4429210000
    ],
    [
        "2022-04-08T09:00:00Z",
        0.02242,
        0.022655,
        0.022415,
        0.02256,
        3696310000
    ],
    [
        "2022-04-08T10:00:00Z",
        0.02257,
        0.0226,
        0.02247,
        0.022505,
        1944950000
    ],
    [
        "2022-04-08T11:00:00Z",
        0.022505,
        0.022505,
        0.02215,
        0.02228,
        6295610000
    ],
    [
        "2022-04-08T12:00:00Z",
        0.02227,
        0.022415,
        0.022005,
        0.022165,
        8071480000
    ],
    [
        "2022-04-08T13:00:00Z",
        0.022165,
        0.022355,
        0.022115,
        0.02229,
        3663870000
    ],
    [
        "2022-04-08T14:00:00Z",
        0.02229,
        0.022305,
        0.02218,
        0.022235,
        2387650000
    ],
    [
        "2022-04-08T15:00:00Z",
        0.02225,
        0.02248,
        0.022235,
        0.02236,
        4846960000
    ]
] as [string, number, number, number, number, number][];

export function App() {
    const [count, setCount] = useState<number>();

    const data = useMemo(() => DATA.slice(0, count), [count]);

    const dataDonut = useMemo(() => data.map(i => i[5]), [data]);

    const dataLine = useMemo(() => data.map(i => ({
        dateTime: i[0],
        value: i[4],
    })), [data]);

    const dataCandlesticks = useMemo(() => data.map(i => ({
        dateTime: i[0],
        open: i[1],
        high: i[2],
        low: i[3],
        close: i[4],
        volume: i[5],
    })), [data]);

    const handleChange = useCallback(e => {
        if (Number(e.target.value) >= 0 && Number(e.target.value) <= DATA.length) {
            setCount(e.target.value === '' ? undefined : e.target.value)
        }
    }, []);

    return (
        <div className="container">
            <h2>Количество элементов (от 0 до {DATA.length})</h2>
            <input type='number' value={count} onChange={handleChange} />
            <h2>Пончиковая диаграмма</h2>
            <DonutChart data={dataDonut} />
            <h2>Линейный график</h2>
            <LineChart data={dataLine} />
            <h2>Линейный график версия 2</h2>
            <LineChartV2 data={dataLine} />
            <h2>Линейный график версия 3</h2>
            <LineChartV3 data={dataLine} />
            <h2>Свечной график</h2>
            <CandlestickChart data={dataCandlesticks} />
            <h2>Свечной график версия 2</h2>
            <CandlestickChartV2 data={dataCandlesticks} />
        </div>
    );
}
